## 开发环境 编译说明
windows/Ubuntu + qtCreator 3.4.2(Qt 5.5.0)
1.网络设置时去宏修改自己的IP和端口

### 功能
#### 客户端Client
1.连接服务端获取数据(天气 新闻 传感器等)
2.切换分支才能看到xx管理信息系统

##### 服务端Server
1.服务器未检测到连接只可以使用单机功能-自定义开关按钮实现
2.点击开启服务器才能连接到服务器
3.接收显示区域放置历史数据信息(天气 传感器)
4.客户端连接后发送信息按钮才能使用

#### 数据库(包括测试的)设计
数据来源
0.第三方数据源
1.底层传感器传回
2.软件运行/系统调试等信息
3.客户端(安卓 非开发板)发给服务器
4.服务器发给客户端

存储方式
1.写入本地文件(缓存到文件)
2.sqlite3数据库

## 项目规划
目标
智能家居后端服务提供(数据模型 接口,这个项目既是大项目一部分,又可以单独立项)
客户端:终端(带触控屏的控制台-可能与另外一台服务器通信的服务器)用

需求
0.使用列表说明  单元测试
1.模块化(网络开关-按了从其他服务器获取数据就开始获取数据 开启服务器-供客户端进行使用)
2.存储数据 并提供给下面(只是硬件模块需要的),作为手机客户端数据源 获取传感器数据
3.客服端(非手机客户端):界面显示(传感器数据 操作 菜单) 基础的控制(串口通信) 
4.与本地服务器进行交互 弹幕发送/接收
5.FTP (手机下载log文件)  runLog记录到本地数据库
6.后期优化(可能遇到问题):加语音搜索族谱  输入sql攻击  ；大数据量；使用说明；各种鄙视  加解密

框架设计(设计可复用组件)
1.UI->拖动式(但要明确如何转换为代码)->代码
2.网络接口 数据库操作类
3.串口通信 http://blog.csdn.net/wangzhen209/article/details/52605514
http://blog.csdn.net/qq_27312943/article/details/52900527

详细设计
toggleButton自定义 http://blog.csdn.net/liang19890820/article/details/52164289
bug及风险控制(工具 API http://www.kuqin.com/qtdocument/index.html)
原则:每次新版本发布时可控bug数量在3个以下 开发新模块(测通后再引入)
1.点击按钮会退出-前置声明出错
2.网络连接没加判断 (之前:需要开虚拟机和先打开服务端)
3.sqlite3数据库连接接口
前端 4.生成单页story

模块划分
1.网络通信(bearer management是什么?)步骤 概念关系(理清server socket 端口 进程 之间关系 分析需求:发送弹幕是一个socket还是一个server) 坑 http://blog.csdn.net/chenlong12580/article/details/7431864
http://blog.csdn.net/chenlong12580/article/details/7434114  -udp & hostinfo
[拆包黏包 http://blog.csdn.net/sweettool/article/details/77018506]
2.串口模块测试单独模块加入
3.单元测试

数据结构

通信协议

------------------------------- 
参考设计说明
开发系统：Windows10 64位 
		    Ubuntu 14.04 32 位
软件版本：Qt 4.8.6
		    IAR .0
          Altium Designer 13.0
工具链:arm-linux-gcc 4.4.3

系统实现的主要功能如下所示：
1.	STM32下位机
(1)	应用了小型的嵌入式操作系统μC/OS-II；
(2)	各个传感器的数据以多任务的形式
获取，实时性很好；
(3)	数据调试使用STM32串口1；
(4)	数据的发送使用STM32的串口3，并以任务的形式进行打包发送，具体数据帧格式请看代码；
(5)	STM32接收数据采用终端方式，当有数据到来时会触发终端，进入数据接收解析过程，在此过程中会对数据的帧头等信息进行判断；
2.	Zigbee无线通信
Zigbee部分其实没有太多功能，一句话概括就是一个串口透传功能！本来当初计划直接使用zigbee驱动各个传感器，然后组网后发送给协调器，考虑到既然学习了STM32，就利用上吧！其实这里完全可以直接使用zigbee，不使用STM32的。
两套方案的编码工作其实早就已经完成了，思考了好久才决定采用STM32+zigbee方式，这样下来可以学到很多，尤其是μC/OS-II系统的移植，还是很深奥的，很值的以后继续深入的去学习。
3.	ARM上位机
ARM上位机采用友善支臂的SMART210开发板，自己后续移植了Qt4.8。上位机主要实现了一下几个功能：
(1)	模拟室内三个场景：卧室、客厅、厨房
(2)	分别对这个三个场景下的温度，湿度以及烟雾浓度进行一个测量并显示；
(3)	使用LED灯模拟室内照明灯；
(4)	使用人体红外传感器进行检测是否有人(这个传感器有点不靠谱，最后取消了)
(5)	当初计划添加视频监控，到了后期发现工作量太大，没有时间做了，所以就没有完成，这点以后会添加上去的。
(6)	代码中使用了“liudianwu”分享的一些api，由于时间紧，所以直接拿来用了，在此感谢！
(7)	代码重复率有点高，好几处的button样式是相同的，完全可以提取出来，在此请大家海涵。

开发记录
********5.19*********
解决问题:循环显示天气信息
获取紧急信息:默认显示(请求回来的)

未实现待优化:保存天气数据 写入文件

终端与本地服务器通信:http（传输天气数据） tcp（socket dmSocket） udp
终端与第三方服务器通信:
第三方服务器与本地服务器通信(保存文件):http（请求天气数据）
本地服务器设置:

总结:tcp通信依赖socket和端口

********5.18*********
ubuntu apache：http://192.168.1.209/  容器 后台登录 规范代码 牢固基础
注意问题:xml数据不能用json解析 资源文件删除需要修改Pro文件 UI类名改了转到槽会找不到MainWindow
今日任务:实现播放视频功能（rollwidget项目）-参考网友例子       显示天气
搭建服务器:备份文件(获得开发板app第一次请求到的api数据)[实现逻辑:是否第一次请求(data provider能否提示是否有数据更新?)->保存到服务器->当前是否需要最新消息]
网络连接模型:终端/服务器一直连接网络还是定期访问数据源,将取的的数据保存在服务器,然后根据需要同步到终端上? *本地服务器定期请求网络资源并推送更新给终端(暂时保存在文件)-http笔记和例子
  
界面优化 视频播放mplay(win下命令行播放(显卡)[开发板buffer] 命令+文件)[进程]嵌套:查看窗口ID 
天气 文字广告 ---开发板请求(服务器不知道终端地址)

未来目标:机器人 语音备忘录(情景触发,可用录像眼镜收集场景并分析)
1.rollText实现熟悉(添加现有文件,widget提升为RollTxet)
2.扫雷 http://www.2cto.com/kf/201607/524654.html

搭建服务器:备份文件(获得开发板app第一次请求到的api数据)[实现逻辑:是否第一次请求(data provider能否提示是否有数据更新?)->保存到服务器->当前是否需要最新消息]
网络连接模型:终端/服务器一直连接网络还是定期访问数据源,将取的的数据保存在服务器,然后根据需要同步到终端上? *本地服务器定期请求网络资源并推送更新给终端(暂时保存在文件)-http笔记和例子
实现播放视频功能 参考网友例子 
界面优化 视频播放mplay 天气 文字广告
********5.17*********
分模块设计:网络模块(TCP UDP HTTP共存) 滚动显示模块 视频播放模块 普通推送显示模块 固定区域UI模块
label滚动信息优化(paint设置在image上再给label)  http、tcp特定文件放特殊地区 不同时间长度获取一次信息
使用注意:修改网络连接地址 资料更换位置
新建项目(E:\qtProject\lezhiServer lezhiClient)
服务器消息分类:紧急通知 新闻/招聘信息 天气 活动 
3.0版本构思:推送视频 播放电视节目 黑科技:服务器远程控制终端界面效果(截图)
2.0版本构思:连接U盘后通过后台修改资料 需要一直保持网络连接吗(第一次请求的文件保存)  连接数据库
实现功能:显示当前时间 布局间隙调整 搭建基本的框架

素材添加:以后期维护方便为主
规格说明:二维码80*80 

******************************************************************************** 

0.开发修改记录  (qt做的简历面试)
全程围绕:复习之前知识 总结并将用到的放到项目中 收集一些可用的工具
1.视频播放库选择    哪个好用    支持格式   需要解码器吗
qtmultimedia(multimediawidgets)
解码器  K-Lite Codec Pack

3.推送数据 UDP、TCP

********************************************************************************

************备用代码*************
图片大小缩放
QString temppath=file_path+"\\"+picture_name_list[flagnum];
QImage image,result;
image.load(temppath);//temppath为图片的路径
result = image.scaled(ui->label_2->width(), ui->label_2->height(),Qt::IgnoreAspectRatio, Qt::SmoothTransformation);//放缩图片，以固定大小显示
ui->label_2->setPixmap(QPixmap::fromImage(result));//在Label控件上显示图片

********************************
总结
1.控件加入图片方式：1.setStyleSheet 2.通过QPalette,这置控件的背景色  3.重载paintEvent事件
2.注意:qt做http tcp通信很方便(udp丢包严重),C下udp超过2k数据都能发送 一般发送数据包在1.4K以内 通信包装通信协议(应用层做数据校验)